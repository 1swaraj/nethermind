FROM mcr.microsoft.com/dotnet/core/sdk:3.1-alpine AS build

COPY src/ .

RUN echo "@v3.12 http://dl-cdn.alpinelinux.org/alpine/v3.12/main/" >> /etc/apk/repositories && \
    apk add --no-cache git@v3.12 openssl-dev@v3.12 && \
    dotnet publish Nethermind/Nethermind.State.Test.Runner -c release -o out

FROM mcr.microsoft.com/dotnet/core/sdk:3.1-alpine

COPY --from=build /out .

ENTRYPOINT [ "./nethtest" ]
